<!DOCTYPE html>
<html>
<body>
<script type="text/javascript">
  navigator.bluetooth.requestDevice({
    filters:
      [
        { name: Makeblock_LE },
        { services: [0xFFE1] },
      ]
  })
  
  .then(device => {
      myDevice = device;
      return device.gatt.connect();
    })
  
  .then(server => server.getPrimaryService(0xFFE1))
.then(service => service.getCharacteristic(FFE3))

  const code = Number(event.target.dataset.code);
  if (code === 1) {
    toggleLigthCharacteristic.writeValue(Uint8Array.of(code));
    return;
  }
  toggleLigthCharacteristic.readValue()
    .then(currentCode => {
      const convertedCode = currentCode.getUint8(0);
      toggleLigthCharacteristic.writeValue(
        Uint8Array.of(convertedCode === code ? 0 : code)
      );
    });
  
  myDevice.gatt.disconnect();
toggleItemsEventListeners('removeEventListener');
toggleButtonsVisible();
toggleLigthCharacteristic = undefined;
myDevice = undefined;
  </script>
</body>
</html>
